[{
  "requirements": [
    { "bin": "urldedupe", "install": "git clone https://github.com/ameenmaali/urldedupe.git --depth 1 &>/dev/null && cd urldedupe && cmake CMakeLists.txt &>/dev/null && make &>/dev/null && mv urldedupe /usr/local/bin/ && cd .. && rm -rf urldedupe" },
    { "bin": "pvreplace", "install": "gocl -i github.com/rix4uni/pvreplace" },
    { "bin": "xssrecon", "install": "gocl -i github.com/rix4uni/xssrecon" },
    { "bin": "unew", "install": "go install github.com/rix4uni/unew@latest" }
  ],
  "command": [
    "cat ${INPUT} | urldedupe -s | grep -aE '=|%3D' | egrep -aiv '.(jpg|jpeg|gif|css|tif|tiff|png|ttf|woff|woff2|icon|pdf|svg|txt|js)' | egrep -av '/[0-9]+[-/][0-9]+[-/][0-9]+' | xssrecon --silent --json | unew -a xssrecon-json.output",
    "cat xssrecon-json.output | jq -r 'select(.reflected==true) | .baseurl' | unew xssrecon-filtered.output",
    "curl -s 'https://raw.githubusercontent.com/rix4uni/WordList/refs/heads/main/payloads/xss/favourite.txt' | unew -q favourite.txt && if grep -qv '^rix4uni' 'favourite.txt';then sed -i 's/^/rix4uni/' 'favourite.txt';fi",
    "cat xssrecon-filtered.output | pvreplace -silent -payload favourite.txt -fuzzing-part param-value -fuzzing-type replace -fuzzing-mode single | xsschecker -nc -match 'rix4uni' -vuln -t 100 -timeout 15 -retries 1 -filter 2>/dev/null | unew -el -t ${OUTPUT}",
    "echo -e '\\n\\033[1;32mYou can run pyxss to check false positive or check manually one by one url in chrome\\033[0m'"
  ],
  "example": "garudrecon workflow rix4uni-xssrecon -i domain.com.urls -o domain.com.xssrecon",
  "description": "Custom XSS checker workflow with xssrecon"
}]
