#!/bin/bash

# Default config file path
source "configuration/garudrecon_max.cfg"

# Help function
function show_help() {
  cat <<EOF
GarudRecon is a comprehensive bash-based reconnaissance automation framework that streamlines the asset discovery and vulnerability assessment process for security professionals and bug bounty hunters. This tool orchestrates over 80+ open-source security tools to provide thorough reconnaissance capabilities across multiple attack vectors.

Usage:
  garudrecon [command]

Available Commands:
  install                 Install the tool and all required dependencies.
  smallscope              Quick recon for a single host or subdomain (e.g. support.domain.com).
  mediumscope             Moderate recon for a wildcard domain (e.g. *.domain.com) with optional vuln checks.
  largescope              Full-scale recon for an organization.
  cidrscope               Run a full scan against one or more CIDR ranges.
  workflow                Chain multiple tools into a reusable pipeline so you can run complex scans with a single command.
  fleet                   Distribute work across many VPS instances â€” split input automatically and run modules in parallel on 100+ hosts.
  cronjobs                Schedule and monitor recurring recon tasks (subdomains, open ports, JS leaks, templates, alerts).

Flags:
  -h, --help     help for garudrecon
  -v, --version  Display the current version

Use "garudrecon [command] --help" for more information about a command.
EOF
}

# Check if no args
if [[ $# -eq 0 ]]; then
  show_help
  exit 0
fi

COMMAND=$1
shift

case "$COMMAND" in
  install)
    bash "$(dirname "$0")/cmd/install" "$@"
    ;;
  smallscope)
    bash "$(dirname "$0")/cmd/smallscope" "$@"
    ;;
  mediumscope)
    bash "$(dirname "$0")/cmd/mediumscope" "$@"
    ;;
  largescope)
    bash "$(dirname "$0")/cmd/largescope" "$@"
    ;;
  cidrscope)
    bash "$(dirname "$0")/cmd/cidrscope" "$@"
    ;;
  workflow)
    bash "$(dirname "$0")/cmd/workflow" "$@"
    ;;
  fleet)
    bash "$(dirname "$0")/cmd/fleet" "$@"
    ;;
  cronjobs)
    bash "$(dirname "$0")/cmd/cronjobs" "$@"
    ;;
  -v|--version)
    echo "GarudRecon version: $VERSION"
    ;;
  -h|--help)
    show_help
    ;;
  *)
    echo "Unknown command: $COMMAND"
    echo "Use 'garudrecon --help' for usage."
    exit 1
    ;;
esac
